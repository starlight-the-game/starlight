(self.webpackChunkstarlight=self.webpackChunkstarlight||[]).push([[6253],{5203:(s,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>k});var n=a(5043),t=a(6213),r=(a(4166),a(3216)),c=a(5475),l=a(4320),i=a(6494),o=a(9883),j=a(653),d=a(1832),h=a(8440),u=a(4797),m=a(9895),g=a(972),v=a(5164),p=a(9056),x=(a(4789),a(3900)),b=a(3204),y=a(579);const f="https://cluster1.swyrin.id.vn";const k=function(){var s,e;const a=(0,r.zy)(),k=(null===(s=a.state)||void 0===s?void 0:s.currentSong)||null,N=(null===(e=a.state)||void 0===e?void 0:e.currentSongIndex)||0,[w,S]=(0,n.useState)(k),[C,E]=(0,n.useState)(N),[L,z]=(0,n.useState)(!1),[A,I]=(0,n.useState)(!1),[q,T]=(0,n.useState)([]),[U,$]=(0,n.useState)(null),[_,O]=(0,n.useState)(null),[D,P]=(0,n.useState)(""),H=new x.A(q,{keys:["title"],threshold:.3}),M=D?H.search(D).map((s=>s.item)):q;(0,n.useEffect)((()=>{S(k),E(N)}),[k,N]),(0,n.useEffect)((()=>{(async()=>{try{const s=(await t.A.get(`${f}/api/track/all`,{headers:{"Content-Type":"application/json"}})).data;T(s),s.length>0&&(E(0),S(s[0]))}catch(s){console.error("Error fetching data:",s)}})()}),[]),(0,n.useEffect)((()=>{C>=q.length&&E(0)}),[C,q.length]);const B=(0,n.useCallback)((()=>{const s=document.querySelector(".background-image img");s&&(s.classList.add("fade-out"),s.addEventListener("transitionend",(()=>{E((s=>{const e=(s+1)%q.length;return S(q[e]),e})),s.classList.remove("fade-out")}),{once:!0}))}),[q]),F=(0,n.useCallback)((()=>{const s=document.querySelector(".background-image img");s&&(s.classList.add("fade-out"),s.addEventListener("transitionend",(()=>{E((s=>{const e=(s-1+q.length)%q.length;return S(q[e]),e})),s.classList.remove("fade-out")}),{once:!0}))}),[q]),G=()=>{I(!0)};(0,n.useEffect)((()=>{let s;return w&&w.audioUrl&&(s=new Audio(w.audioUrl),s.loop=!0,s.play().catch((s=>console.error("Error playing audio:",s)))),()=>{s&&(s.pause(),s=null)}}),[w]),(0,n.useEffect)((()=>{const s=document.querySelector(".background-image img");s&&s.addEventListener("transitionend",(()=>{s.classList.remove("morph")}))}),[w]);const K=s=>{const e=document.querySelector(s);e&&(e.classList.add("hover"),setTimeout((()=>{e.classList.remove("hover")}),300))};(0,n.useEffect)((()=>{const s=s=>{39===s.keyCode?(B(),K(".next-btn")):37===s.keyCode&&(F(),K(".prev-btn"))};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}}),[B,F]),(0,n.useEffect)((()=>{const s=s=>{27===s.keyCode&&(s.preventDefault(),G())};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}}),[]);const R=async(s,e)=>{try{const a=await t.A.get(`${f}${s}`,{headers:{"Content-Type":"csv"===e?"json":"application/json"}});return a.data}catch(a){return console.error("Error fetching heatmap data:",a),[]}},J=(0,n.useCallback)((async function(s,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"json";const n=document.querySelector(e);if(!n)return;n.innerHTML="";const t=await R(s,a),r=new p.A;return r.paint({data:{source:t,type:a,x:"x",y:"y",value:"value"},range:30,domain:{type:"column",label:{text:s=>`${Math.floor(s/1e3)}s`,textAlign:"center",position:"top"}},subDomain:{type:"row",label:{text:"Accuracy",textAlign:"start",position:"start"},width:20,height:20,gutter:5},scale:{color:{type:"threshold",range:["#14432a","#166b34","#37a446","#4dd05a"],domain:[25,50,75,100]}},itemSelector:e,legend:{show:!0,position:"bottom"},verticalOrientation:!0,itemName:["beat","beats"]}),r}),[]),Q=(0,n.useCallback)((async function(s,e,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"json";const t=await R(a,n),r=t.judgment||{},c=t.overallScore||0;return(0,y.jsxs)("div",{className:"heatmap-container",children:[(0,y.jsx)("h3",{children:s}),(0,y.jsxs)("div",{className:"heatmap-details",children:[(0,y.jsxs)("div",{className:"judgement-column",children:[(0,y.jsx)("div",{className:"judgement-title",children:"Combo"}),(0,y.jsxs)("div",{children:["CP: ",r.cp||1e3]}),(0,y.jsxs)("div",{children:["P: ",r.p||1e3]}),(0,y.jsxs)("div",{children:["G: ",r.g||1e3]}),(0,y.jsxs)("div",{children:["B: ",r.b||1e3]}),(0,y.jsxs)("div",{children:["M: ",r.m||1e3]})]}),(0,y.jsxs)("div",{className:"heatmap-column",children:[(0,y.jsxs)("div",{className:"overall-score",children:["\u2728",c||1e5,"\u2728"]}),(0,y.jsx)("div",{id:e})]})]})]})}),[]);return(0,n.useEffect)((()=>{(async()=>{const s=await J("/api/user/score/recent","#heatmap-latest-container","json"),e=await Q("Latest Play","heatmap-latest-container","/api/user/score/recent","json");$(e),setInterval((async()=>{const e=await R("/api/user/score/recent","json");s.fill({source:e})}),6e4)})()}),[J,Q]),(0,n.useEffect)((()=>{(async()=>{const s=await J("/api/user/score/all","#heatmap-best-container","json"),e=await Q("Best Score","heatmap-best-container","/api/user/score/all","json");O(e),setInterval((async()=>{const e=await R("/api/user/score/all","json");s.fill({source:e})}),6e4)})()}),[J,Q]),(0,y.jsx)("div",{className:"historypage",children:(0,y.jsxs)(n.Suspense,{fallback:(0,y.jsx)("div",{children:"Loading..."}),children:[(0,y.jsxs)("header",{className:"navbar",children:[(0,y.jsxs)("div",{id:"nav-icon1",className:L?"open":"",onClick:()=>{z(!L)},children:[(0,y.jsx)("span",{}),(0,y.jsx)("span",{}),(0,y.jsx)("span",{})]}),(0,y.jsxs)("nav",{className:"nav-links left",children:[(0,y.jsxs)(c.N_,{to:"/songpage",children:[(0,y.jsx)("img",{src:o,alt:"Songs",className:"nav-icon"}),(0,y.jsx)("span",{children:"Songs"})]}),(0,y.jsxs)(c.N_,{to:"/historypage",children:[(0,y.jsx)("img",{src:j,alt:"History",className:"nav-icon"}),(0,y.jsx)("span",{children:"History"})]})]}),(0,y.jsx)("div",{className:"logo-container",children:(0,y.jsx)(c.N_,{to:"/songpage",className:"logo",children:(0,y.jsxs)("span",{className:"star-light",children:[(0,y.jsx)("span",{children:"STAR"}),(0,y.jsx)("img",{src:l,alt:"Logo",className:"logo-icon",style:{verticalAlign:"middle"}}),(0,y.jsx)("span",{className:"light",children:"LIGHT"})]})})}),(0,y.jsxs)("nav",{className:"nav-links right",children:[(0,y.jsxs)(c.N_,{to:"/eventpage",state:{currentSong:w,currentSongIndex:C},children:[(0,y.jsx)("img",{src:d,alt:"Events",className:"nav-icon"}),(0,y.jsx)("span",{children:"Events"})]}),(0,y.jsxs)(c.N_,{to:"/storepage",state:{currentSong:w,currentSongIndex:C},children:[(0,y.jsx)("img",{src:h,alt:"Store",className:"nav-icon"}),(0,y.jsx)("span",{children:"Store"})]})]}),(0,y.jsxs)("div",{className:"sidebar "+(L?"open":""),style:{backgroundImage:`url(${u})`},children:[(0,y.jsx)("div",{className:"search-bar-container",children:(0,y.jsxs)("form",{className:"search-form",onSubmit:s=>{s.preventDefault()},children:[(0,y.jsx)("label",{htmlFor:"search",className:"screen-reader-text",children:"Search"}),(0,y.jsx)("input",{type:"search",id:"search",placeholder:"Search songs...",value:D,onChange:s=>{P(s.target.value)},className:"search-field"}),(0,y.jsx)("button",{type:"submit",className:"search-submit",children:(0,y.jsx)(b.KSO,{className:"search-bar-icon"})})]})}),(0,y.jsx)("ul",{children:M.map(((s,e)=>(0,y.jsxs)("li",{className:"song-item",onClick:()=>S(s),children:[(0,y.jsxs)("div",{className:"song-info-sidebar",children:[(0,y.jsx)("img",{src:m,alt:"Song Sidebar Icon",className:"song-sidebar-icon"}),(0,y.jsx)("span",{className:"sidebar-song",children:s.title})]}),(0,y.jsx)("div",{className:"song-bg",style:{backgroundImage:`url(${s.backgroundUrl})`}}),(0,y.jsx)("span",{className:"sidebar-song-title",children:s.title})]},e)))})]}),(0,y.jsx)("div",{className:"leave-button",children:(0,y.jsx)("img",{src:i,alt:"Leave",className:"leave-icon",style:{width:"26px",height:"26px"},onClick:G})})]}),(0,y.jsxs)("div",{className:"content-layer",children:[(0,y.jsx)("div",{className:"background-image",children:(0,y.jsx)("img",{src:w&&w.backgroundUrl?`${w.backgroundUrl}`:"",alt:"Background"})}),(0,y.jsxs)("div",{className:"song-navigation",children:[(0,y.jsx)("button",{className:"nav-btn prev-btn",onClick:F,children:(0,y.jsx)("img",{src:g,alt:"Previous",style:{width:"21px",height:"21px"}})}),(0,y.jsx)("button",{className:"nav-btn next-btn",onClick:B,children:(0,y.jsx)("img",{src:v,alt:"Next",style:{width:"21px",height:"21px"}})})]}),U,_]}),A&&(0,y.jsx)("div",{className:"popup-overlay",children:(0,y.jsxs)("div",{className:"popup-content",children:[(0,y.jsx)("h2",{children:"Confirm Leave"}),(0,y.jsx)("p",{children:"Are you sure you want to leave the game?"}),(0,y.jsx)("button",{className:"stay-button",onClick:()=>{I(!1)},children:"Stay"}),(0,y.jsx)("button",{className:"leave-button",onClick:()=>{window.location.href="/"},children:"Leave"})]})})]})})}},2135:(s,e,a)=>{var n={"./af.js":[7749,7749],"./am.js":[9716,9716],"./ar-dz.js":[1820,1820],"./ar-iq.js":[4744,4744],"./ar-kw.js":[8112,8112],"./ar-ly.js":[8509,8509],"./ar-ma.js":[9724,9724],"./ar-sa.js":[7278,7278],"./ar-tn.js":[6304,6304],"./ar.js":[1417,1417],"./az.js":[1473,1473],"./be.js":[4811,4811],"./bg.js":[7021,7021],"./bi.js":[3543,3543],"./bm.js":[7683,7683],"./bn-bd.js":[7201,7201],"./bn.js":[2278,2278],"./bo.js":[2997,2997],"./br.js":[642,642],"./bs.js":[369,369],"./ca.js":[1454,1454],"./cs.js":[9540,9540],"./cv.js":[5615,5615],"./cy.js":[2678,2678],"./da.js":[29,29],"./de-at.js":[859,859],"./de-ch.js":[7597,7597],"./de.js":[9425,9425],"./dv.js":[264,264],"./el.js":[6375,6375],"./en-au.js":[7196,7196],"./en-ca.js":[8078,8078],"./en-gb.js":[847,847],"./en-ie.js":[5172,5172],"./en-il.js":[419,419],"./en-in.js":[8517,8517],"./en-nz.js":[6998,6998],"./en-sg.js":[1624,1624],"./en-tt.js":[2834,2834],"./en.js":[3513,3513],"./eo.js":[9354,9354],"./es-do.js":[7138,7138],"./es-mx.js":[1958,1958],"./es-pr.js":[7601,7601],"./es-us.js":[2947,2947],"./es.js":[7534,7534],"./et.js":[4383,4383],"./eu.js":[3064,3064],"./fa.js":[5427,5427],"./fi.js":[3883,3883],"./fo.js":[1873,1873],"./fr-ca.js":[5199,5199],"./fr-ch.js":[6016,6016],"./fr.js":[3782,3782],"./fy.js":[2139,2139],"./ga.js":[5266,5266],"./gd.js":[717,717],"./gl.js":[5301,5301],"./gom-latn.js":[4531,4531],"./gu.js":[5886,5886],"./he.js":[8541,8541],"./hi.js":[8057,8057],"./hr.js":[8856,8856],"./ht.js":[1630,1630],"./hu.js":[4589,4589],"./hy-am.js":[7604,7604],"./id.js":[7819,7819],"./is.js":[1634,1634],"./it-ch.js":[1919,1919],"./it.js":[4520,4520],"./ja.js":[4535,4535],"./jv.js":[8646,8646],"./ka.js":[9446,9446],"./kk.js":[6308,6308],"./km.js":[8546,8546],"./kn.js":[2383,2383],"./ko.js":[8456,8456],"./ku.js":[1050,1050],"./ky.js":[1870,1870],"./lb.js":[2732,2732],"./lo.js":[1391,1391],"./lt.js":[8042,8042],"./lv.js":[7248,7248],"./me.js":[7648,7648],"./mi.js":[8996,8996],"./mk.js":[3454,3454],"./ml.js":[2463,2463],"./mn.js":[6593,6593],"./mr.js":[9221,9221],"./ms-my.js":[3661,3661],"./ms.js":[1478,1478],"./mt.js":[4807,4807],"./my.js":[52,52],"./nb.js":[2878,2878],"./ne.js":[8831,8831],"./nl-be.js":[8292,8292],"./nl.js":[9600,9600],"./nn.js":[7866,7866],"./oc-lnc.js":[1542,1542],"./pa-in.js":[4373,4373],"./pl.js":[5278,5278],"./pt-br.js":[2587,2587],"./pt.js":[182,182],"./rn.js":[2534,2534],"./ro.js":[5141,5141],"./ru.js":[6315,6315],"./rw.js":[5277,5277],"./sd.js":[6033,6033],"./se.js":[7618,7618],"./si.js":[2694,2694],"./sk.js":[8988,8988],"./sl.js":[7449,7449],"./sq.js":[3998,3998],"./sr-cyrl.js":[3878,3878],"./sr.js":[2795,2795],"./ss.js":[5796,5796],"./sv-fi.js":[9745,9745],"./sv.js":[1615,1615],"./sw.js":[7e3,7e3],"./ta.js":[7709,7709],"./te.js":[6849,6849],"./tet.js":[8673,8673],"./tg.js":[1215,1215],"./th.js":[4550,4550],"./tk.js":[8371,8371],"./tl-ph.js":[4899,4899],"./tlh.js":[7672,7672],"./tr.js":[8772,8772],"./tzl.js":[6178,6178],"./tzm-latn.js":[7939,7939],"./tzm.js":[3457,3457],"./ug-cn.js":[330,330],"./uk.js":[5366,5366],"./ur.js":[8109,8109],"./uz-latn.js":[5807,5807],"./uz.js":[3221,3221],"./vi.js":[2907,2907],"./x-pseudo.js":[9599,9599],"./yo.js":[9881,2262],"./zh-cn.js":[6484,6484],"./zh-hk.js":[8020,8020],"./zh-tw.js":[3220,3220],"./zh.js":[1192,1192]};function t(s){if(!a.o(n,s))return Promise.resolve().then((()=>{var e=new Error("Cannot find module '"+s+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=n[s],t=e[0];return a.e(e[1]).then((()=>a.t(t,19)))}t.keys=()=>Object.keys(n),t.id=2135,s.exports=t}}]);
//# sourceMappingURL=6253.5971e4c6.chunk.js.map